#pragma once

namespace Exploits
{
	void Hook( SDK::APlayerController* PlayerController )
	{
		static SDK::APlayerController* OldPlayerController = nullptr;
		if ( OldPlayerController != PlayerController )
		{
			ShadowVMT( ).Hook( PlayerController , 237 , GetControlRotation , &GetControlRotationOriginal );
			OldPlayerController = PlayerController;
		}

		if ( Settings::SilentAim )
		{
			SDK::APlayerPawn_Athena_C* AcknowledgedPawn = PlayerController->AcknowledgedPawn( );
			if ( AcknowledgedPawn )
			{
				SDK::AFortWeapon* CurrentWeapon = AcknowledgedPawn->CurrentWeapon( );
				if ( CurrentWeapon )
				{
					if ( SDK::GameplayStatics->ObjectIsA( CurrentWeapon , Implementation::Weapon ) )
					{
						static SDK::AFortWeapon* OldCurrentWeapon = nullptr;
						if ( OldCurrentWeapon != CurrentWeapon )
						{
							ShadowVMT( ).Hook( CurrentWeapon , 252 , GetWeaponTargetingTransform , &GetWeaponTargetingTransformOriginal );
							OldCurrentWeapon = CurrentWeapon;
						}
					}
				}
			}
		}
	}
}